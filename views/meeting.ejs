<h3>Meeting <strong><%= meeting.name %></strong></h3>
<div id="total">â‚¬<span id="meetingTotalValue"><%= meeting.total %></span></span></div>

<div  id="form" class="form-inline">
</div>

<script src="/js/counter.js"></script>

<script type="text/template" id="attendee_form_template">
    <span><input type="text" autocomplete="off" placeholder="Price per Hour..." class="focused input input-small" id="create-meeting-rate"></span>
    <span><a id="join_attendee" class="btn btn-inverse"> Join </a> </span>
</script>


<script>

  var counter = new Meetoring.Counter(1, '#meetingTotalValue');
  var meeting = <%- JSON.stringify(meeting) %>;
  counter.init(meeting);
 
  _.templateSettings = {
     interpolate : /\{\{(.+?)\}\}/g
   };
   var render = _.template($("#attendee_form_template").html());
   $("#form").html(render({}));

   $('#join_attendee').click(function(event){ 
     var rate =  $("#create-meeting-rate").attr('value');
     var success = function(meeting){
        $("#form").empty();
        $("<a />").attr('class', 'btn btn-inverse').html('Leave').appendTo("#form");
        counter.restart(meeting);
      };
    
	   $.ajax({
	      type: 'POST',
	      url: '/join/<%= meeting.id %>',
	      data: {rate: rate},
	      success: success,
	      dataType: 'json'
	   });  
   });
   
   counter.start();
  
</script>